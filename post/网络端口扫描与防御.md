+++
title = '网络端口扫描与防御'
date = 2024-07-15T16:12:33+08:00
+++


网络程序与外部的通讯需要由TCP或者IP传输层的端口承载，换言之，每个端口都是一条通信信道，开放的端口会为外来的攻击行为提供漏洞。

---
以下是五种常见的端口扫描
1. TCP SYN扫描
	
	TCP指传输协议，SYN代表同步传输。TCP SYN传输的过程如下：
主机发送向靶机某端口发送SYN包，靶机的回应有以下两种
	 + 靶机回复RST（Reset复位）包，代表靶机当前端口是关闭的。
	 + 靶机回复SYN/ACK包，目标主机接受后发送RST包表示建立连接。
2. TCP Connect 全连接扫描	

	主机向靶机某端口发送SYN包，靶机会有以下两种回复
	+ 靶机回复RST包，代表靶机当前端口是关闭的。
	+ 靶机回复SYN/ACK包，主机在收到回复后，发送ACK包，随后紧接着发送RST包代表成功建立连接。
	
3. TCP ACK确认扫描
 
	  主机向靶机发送SYN包，靶机会有以下两种回复
	  + 靶机回复RST包，表示端口未被防火墙过滤。
	  + 靶机不回复，表示端口被防火墙过滤。
		
	注意这种扫描只能扫描出端口的过滤情况，无论靶机何种回复，都无法确认端口的开放情况。
4. TCP 秘密扫描
 
	主机向靶机目标端口发送TCP FIN，Xmas tree（flag中的FIN URG PUSH被置为1），NULL（flags全为0）包三种之一。 靶机会有以下两种状态
	+ 不回复，表示靶机目标端口开放或被过滤。
	+ 靶机回复RST包，表示靶机目标端口关闭。

5. UDP 扫描
	主机向靶机目标端口发送UDP包，靶机会有以下两种状态
	+ 靶机不回复，表示目标端口被过滤或开启。
	+ 靶机回复ICMP:portunreachable表示目标端口关闭。

常见的网络端口扫描防御大多数为开启防火墙，关闭ICMP应答与关闭不必要的端口。对于必须开放的端口可以进行端口伪装，也就是把默认的端口号更改来进行防御。

---
使用nmap工具可以对网段内的ip进行端口扫描，nmap的具体使用方式可以查看下方链接
[Nmap使用教程图文教程（超详细）-CSDN博客](https://blog.csdn.net/Javachichi/article/details/133133262)
若是使用虚拟机进行环境模拟，需设置虚拟机网络连接模式为桥接模式。
桥接模式下的虚拟机在网络上相当于是一台独立的主机，可以访问网段内的其他ip地址。
nat模式下的虚拟机相当于主机的一台子设备，只能访问主机本身。
